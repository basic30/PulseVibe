<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pulse Vibe</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://www.youtube.com/iframe_api"></script>
</head>
<body>
    <header>
        <h1>__Pulse Vibe__</h1>
        <p>Feel the vibes !</p>
        <div id="auth-section">
            <button id="login-btn" style="display: block;">Sign In</button>
            <img id="user-profile" src="" alt="User Profile" style="display: none;">
        </div>
    </header>
    <main>
        <div id="search-container">
            <input type="text" id="search" placeholder="Search for music..." />
            <button id="search-button">üîç</button>
        </div>

        <div id="music-list"></div>

        <button id="toggle-playlist-btn">Your Playlist</button>

        <section id="playlist-section" style="display: none;">
            <h2>Your Playlist</h2>
            <div id="temp-playlist"></div>
            <button id="clear-playlist">Clear Playlist</button>
        </section>
    </main>

    <div id="music-player">
        <img id="channel-logo" src="" alt="Channel Logo" />
        <div id="current-track">No track playing</div>
        <button id="prev">‚èÆÔ∏è</button>
        <button id="play-pause">‚ñ∂Ô∏è</button>
        <button id="next">‚è≠Ô∏è</button>
    </div>

    <div id="hidden-player"></div>

    <script>

  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-analytics.js";
  import { getAuth, GoogleAuthProvider, signInWithRedirect, getRedirectResult } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";
        
  const firebaseConfig = {
    apiKey: "AIzaSyDwxKZSVy687iV26zw4Uu2N8-jLQOMo0HU",
    authDomain: "pulse-vibe-53ebb.firebaseapp.com",
    databaseURL: "https://pulse-vibe-53ebb-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "pulse-vibe-53ebb",
    storageBucket: "pulse-vibe-53ebb.firebasestorage.app",
    messagingSenderId: "93642702141",
    appId: "1:93642702141:web:b278ba16a754def6969954",
    measurementId: "G-D365D3GWK3"
  };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        const loginBtn = document.getElementById("login-btn");
        const userProfile = document.getElementById("user-profile");

        loginBtn.addEventListener("click", async () => {
            const provider = new GoogleAuthProvider(app);
            getRedirectResult(auth)
  .then((result) => {
    // This gives you a Google Access Token. You can use it to access Google APIs.
    const credential = GoogleAuthProvider.credentialFromResult(result);
    const token = credential.accessToken;

    // The signed-in user info.
    const user = result.user;
    // IdP data available using getAdditionalUserInfo(result)
    // ...
  }).catch((error) => {
    // Handle Errors here.
    const errorCode = error.code;
    const errorMessage = error.message;
    // The email of the user's account used.
    const email = error.customData.email;
    // The AuthCredential type that was used.
    const credential = GoogleAuthProvider.credentialFromError(error);
    // ...
  });

        function displayUserInfo(user) {
            if (user) {
                loginBtn.style.display = "none";
                userProfile.style.display = "block";
                userProfile.src = user.photoURL;
                console.log(`Welcome, ${user.displayName}`);
            }
        }

        auth.onAuthStateChanged((user) => {
            if (user) {
                displayUserInfo(user);
            } else {
                loginBtn.style.display = "block";
                userProfile.style.display = "none";
            }
        });
    </script>
    <script src="script.js"></script>
</body>
</html>
